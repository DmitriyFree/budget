"use strict";(self["webpackChunkbudget"]=self["webpackChunkbudget"]||[]).push([[455],{455:function(t,e,r){r.r(e),r.d(e,{default:function(){return yt}});var a=r(3396);const n={class:"handler"},i={class:"handler__header"},l=(0,a._)("div",{class:"title"},"Счета",-1),s={class:"handler__content"},d={class:"handler__content-form"};function c(t,e,r,c,o,u){const m=(0,a.up)("app-create-button"),h=(0,a.up)("bill-create-form"),p=(0,a.up)("app-modal"),v=(0,a.up)("bill-list");return(0,a.wg)(),(0,a.iD)("div",n,[(0,a._)("div",i,[l,(0,a.Wm)(m,{class:"btn",onClickButton:u.showCreateModal},null,8,["onClickButton"])]),(0,a._)("div",s,[(0,a._)("div",d,[(0,a.Wm)(p,{"modal-active":o.activeCreateModal,onHideModal:u.hideCreateModal},{default:(0,a.w5)((()=>[(0,a.Wm)(h,{onHideForm:u.hideCreateModal},null,8,["onHideForm"])])),_:1},8,["modal-active","onHideModal"])]),(0,a.Wm)(v)])])}const o={class:"list-header"},u={key:0},m=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",null,"№"),(0,a._)("th",null,"Название"),(0,a._)("th",null,"Валюта"),(0,a._)("th",null,"Начальный баланс"),(0,a._)("th",null,"Действие")])],-1),h={key:1,class:"empty-list"};function p(t,e,r,n,i,l){const s=(0,a.up)("bill-list-item"),d=(0,a.up)("app-pagination"),c=(0,a.up)("bill-edit-form"),p=(0,a.up)("app-modal"),v=(0,a.up)("app-confirm-modal");return(0,a.wg)(),(0,a.iD)("div",o,[l.isEmptyList?((0,a.wg)(),(0,a.iD)("div",h,"Список счетов пуст")):((0,a.wg)(),(0,a.iD)("div",u,[(0,a._)("table",null,[m,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.pageItems,(t=>((0,a.wg)(),(0,a.j4)(s,{key:t.id,bill:t,onDelete:l.deleteHandler,onEdit:l.editHandler},null,8,["bill","onDelete","onEdit"])))),128))])]),(0,a.Wm)(d,{"pages-amount":t.pageCount,page:t.page,onCurrentPage:l.updateList},null,8,["pages-amount","page","onCurrentPage"])])),(0,a.Wm)(p,{"modal-active":i.activeEditForm,onHideModal:l.hideEditForm},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{bill:i.target,onHideForm:l.hideEditForm},null,8,["bill","onHideForm"])])),_:1},8,["modal-active","onHideModal"]),(0,a.Wm)(v,{show:i.activeConfirmForm,onResult:l.deleteBill},null,8,["show","onResult"])])}var v=r(65),y=r(4268),_=r(7139);const B={class:"td-btn"};function b(t,e,r,n,i,l){const s=(0,a.up)("app-edit-button"),d=(0,a.up)("app-delete-button");return(0,a.wg)(),(0,a.iD)("tr",null,[(0,a._)("td",null,(0,_.zw)(r.bill.id),1),(0,a._)("td",null,(0,_.zw)(r.bill.name),1),(0,a._)("td",null,(0,_.zw)(r.bill.currency),1),(0,a._)("td",null,(0,_.zw)(r.bill.startBalance),1),(0,a._)("td",null,[(0,a._)("div",B,[(0,a.Wm)(s,{class:"edit__btn",onClickButton:l.editBill},null,8,["onClickButton"]),(0,a.Wm)(d,{class:"remove__btn",onClickButton:l.confirm},null,8,["onClickButton"])])])])}var g={name:"BillListItem",props:{bill:{type:Object,required:!0}},computed:{...(0,v.Se)(["getConfirmResult"])},methods:{...(0,v.OI)(["changePopupForm","setSelectedBill","setConfirmModalText"]),editBill(){this.$emit("edit",{...this.bill})},async confirm(){this.$emit("delete",{...this.bill})}}},w=r(89);const E=(0,w.Z)(g,[["render",b]]);var C=E,f=r(9242);const F={class:"edit-form"},$={class:"row"},H={class:"label"},k=(0,a._)("label",null,"Название",-1),M={class:"error show"},D={class:"row"},I={class:"label"},S=(0,a._)("label",null,"Валюта",-1),z={class:"error show"},A={class:"row"},L={class:"label"},q=(0,a._)("label",null,"Начальный баланс",-1),x={class:"error"},W=(0,a._)("button",{type:"submit",class:"row btn"}," Изменить ",-1);function P(t,e,r,n,i,l){return(0,a.wg)(),(0,a.iD)("div",F,[(0,a._)("form",{onSubmit:e[6]||(e[6]=(0,f.iM)(((...t)=>l.formHandler&&l.formHandler(...t)),["prevent"]))},[(0,a._)("div",$,[(0,a._)("div",H,[k,(0,a._)("span",M,(0,_.zw)(t.nameError),1)]),(0,a.wy)((0,a._)("input",{required:"",type:"text","onUpdate:modelValue":e[0]||(e[0]=t=>i.candidate.name=t),onInput:e[1]||(e[1]=(...e)=>t.resetNameError&&t.resetNameError(...e))},null,544),[[f.nr,i.candidate.name]])]),(0,a._)("div",D,[(0,a._)("div",I,[S,(0,a._)("span",z,(0,_.zw)(t.currencyError),1)]),(0,a.wy)((0,a._)("select",{required:"","onUpdate:modelValue":e[2]||(e[2]=t=>i.candidate.currency=t),onInput:e[3]||(e[3]=(...e)=>t.resetCurrencyError&&t.resetCurrencyError(...e))},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.getAllCurrencies,(t=>((0,a.wg)(),(0,a.iD)("option",{key:t.id},(0,_.zw)(t.symbol),1)))),128))],544),[[f.bM,i.candidate.currency]])]),(0,a._)("div",A,[(0,a._)("div",L,[q,(0,a._)("span",x,(0,_.zw)(t.startBalanceError),1)]),(0,a.wy)((0,a._)("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=t=>i.candidate.startBalance=t),onInput:e[5]||(e[5]=(...e)=>t.resetStartBalanceError&&t.resetStartBalanceError(...e))},null,544),[[f.nr,i.candidate.startBalance]])]),W],32)])}var Z=r(9117),V={data(){return{nameError:"",currencyError:"",startBalanceError:""}},validations:{candidate:{name:{required:Z.C1,minLength:(0,Z.Ei)(3),maxLength:(0,Z.BS)(30)},currency:{required:Z.C1},startBalance:{integer:Z._L}}},methods:{checkFormData(){return!this.v$.candidate.name.$dirty&&this.v$.candidate.name.required.$invalid?this.nameError="нет значения":!this.v$.candidate.name.$dirty&&this.v$.candidate.name.minLength.$invalid?this.nameError="минимум 3 символа":!this.v$.candidate.name.$dirty&&this.v$.candidate.name.maxLength.$invalid?this.nameError="максимум 30 символа":this.nameError="",!this.v$.candidate.currency.$dirty&&this.v$.candidate.currency.required.$invalid?this.currencyError="нет значения":this.currencyError="",!this.v$.candidate.startBalance.$dirty&&this.v$.candidate.startBalance.integer.$invalid?this.startBalanceError="только число":this.startBalance="",!(this.nameError||this.currencyError||this.startBalanceError)},resetNameError(){this.nameError=""},resetCurrencyError(){this.currencyError=""},resetStartBalanceError(){this.startBalanceError=""},resetForm(){this.candidate.name="",this.candidate.currency="",this.candidate.startBalance=0}}},U=r(3053),N={name:"BillEditForm",mixins:[V],setup(){return{v$:(0,U.ZP)()}},props:{bill:{type:Object,required:!0}},computed:{...(0,v.Se)(["getAllCurrencies"])},data(){return{candidate:{id:1,name:"",currency:"",startBalance:0}}},methods:{...(0,v.nv)(["putBillById"]),async formHandler(){if(this.checkFormData())try{this.candidate.startBalance||(candidate.startBalance=0);const t={id:this.candidate.id,bill:{name:this.candidate.name,currency:this.candidate.currency,startBalance:this.candidate.startBalance}};await this.putBillById(t)}catch(t){}finally{this.$emit("hideForm",!0)}}},watch:{bill(){this.candidate={...this.bill}}},mounted(){this.candidate={...this.bill}}};const j=(0,w.Z)(N,[["render",P]]);var K=j,O={components:{BillListItem:C,BillEditForm:K},mixins:[y.Z],data(){return{target:{},activeConfirmForm:!1,activeEditForm:!1}},computed:{...(0,v.Se)(["getAllBills"]),isEmptyList(){return 0===this.getAllBills.length}},methods:{...(0,v.nv)(["removeBillById"]),async updateList(t){this.page=t,await this.setupPagination(this.getAllBills)},async deleteBill(t){if(t&&this.target.id)try{await this.removeBillById(this.target.id)}catch(e){}this.activeConfirmForm=!1,this.target={}},editHandler(t){this.target=t,this.activeEditForm=!0},deleteHandler(t){this.target=t,this.activeConfirmForm=!0},hideEditForm(t){t&&(this.target={},this.activeEditForm=!1)}},watch:{getAllBills(){this.setupPagination(this.getAllBills)}},async mounted(){await this.setupPagination(this.getAllBills)}};const R=(0,w.Z)(O,[["render",p]]);var Y=R;const T={class:"create-form"},G=(0,a._)("div",{class:"title"},"Новый Счет",-1),J={class:"row"},Q={class:"label"},X=(0,a._)("label",null,"Название",-1),tt={class:"error show"},et={class:"row"},rt={class:"label"},at=(0,a._)("label",null,"Валюта",-1),nt={class:"error"},it={class:"row"},lt={class:"label"},st=(0,a._)("label",null,"Начальный баланс",-1),dt={class:"error"},ct=(0,a._)("button",{type:"submit",class:"row btn"}," ДОБАВИТЬ ",-1);function ot(t,e,r,n,i,l){return(0,a.wg)(),(0,a.iD)("div",T,[(0,a._)("form",{onSubmit:e[6]||(e[6]=(0,f.iM)(((...t)=>l.formHandler&&l.formHandler(...t)),["prevent"]))},[G,(0,a._)("div",J,[(0,a._)("div",Q,[X,(0,a._)("span",tt,(0,_.zw)(t.nameError),1)]),(0,a.wy)((0,a._)("input",{type:"text",required:"","onUpdate:modelValue":e[0]||(e[0]=t=>i.candidate.name=t),onInput:e[1]||(e[1]=(...e)=>t.resetNameError&&t.resetNameError(...e))},null,544),[[f.nr,i.candidate.name]])]),(0,a._)("div",et,[(0,a._)("div",rt,[at,(0,a._)("span",nt,(0,_.zw)(t.currencyError),1)]),(0,a.wy)((0,a._)("select",{required:"","onUpdate:modelValue":e[2]||(e[2]=t=>i.candidate.currency=t),onInput:e[3]||(e[3]=(...e)=>t.resetCurrencyError&&t.resetCurrencyError(...e))},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.getAllCurrencies,(t=>((0,a.wg)(),(0,a.iD)("option",{key:t.id},(0,_.zw)(t.symbol),1)))),128))],544),[[f.bM,i.candidate.currency]])]),(0,a._)("div",it,[(0,a._)("div",lt,[st,(0,a._)("span",dt,(0,_.zw)(t.startBalanceError),1)]),(0,a.wy)((0,a._)("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=t=>i.candidate.startBalance=t),onInput:e[5]||(e[5]=(...e)=>t.resetStartBalanceError&&t.resetStartBalanceError(...e))},null,544),[[f.nr,i.candidate.startBalance]])]),ct],32)])}var ut={name:"BillCreateForm",mixins:[V],setup(){return{v$:(0,U.ZP)()}},data(){return{candidate:{name:"",currency:"",startBalance:0}}},computed:(0,v.Se)(["getAllCurrencies"]),methods:{...(0,v.nv)(["addBill"]),async formHandler(){if(this.checkFormData()){this.candidate.startBalance||(this.candidate.startBalance=0);try{await this.addBill(this.candidate)}catch(t){}finally{this.$emit("hideForm",!0)}}}},watch:{async getAllCurrencies(){const t=this.getAllCurrencies;0==t.length?this.currencyError="у вас нет валют":"у вас нет валют"===this.currencyError&&(this.currencyError="")}}};const mt=(0,w.Z)(ut,[["render",ot]]);var ht=mt,pt={name:"BillView",components:{BillList:Y,BillCreateForm:ht},data(){return{activeCreateModal:!1}},methods:{showCreateModal(){this.activeCreateModal=!0},hideCreateModal(t){t&&(this.activeCreateModal=!1)}}};const vt=(0,w.Z)(pt,[["render",c]]);var yt=vt}}]);
//# sourceMappingURL=455.b4dbfa1e.js.map